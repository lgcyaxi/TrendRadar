# ═══════════════════════════════════════════════════════════════
#                    Extension Configuration
#                    扩展功能配置
# ═══════════════════════════════════════════════════════════════

# 报告去重插件配置 / Report Deduplication Plugin Config
# 该插件合并来自不同平台的相似新闻标题，减少重复内容

# ═══════════════════════════════════════════════════════════════
# 1. 启用设置 / Enable Settings
# ═══════════════════════════════════════════════════════════════
enabled: true                      # 是否启用扩展功能（报告数据去重和合并）
                                   # Enable extension features (report data deduplication and merging)

# 去重策略 / Deduplication strategy
# 可选值 / Options: ollama (AI 判断, 推荐), auto (自动选择), heuristic (纯算法)
strategy: "ollama"


# ═══════════════════════════════════════════════════════════════
# 2. 相似度配置 / Similarity Configuration
# ═══════════════════════════════════════════════════════════════
similarity:
  # 相似度阈值 / Similarity threshold (0.0 - 1.0)
  # 值越高，要求越相似才合并 / Higher value = stricter matching
  threshold: 0.85

  # 候选过滤下限乘数 / Candidate floor multiplier (0.0 - 1.0)
  # Jaccard 低于此值时不使用 AI 判断 / Skip AI check if Jaccard below this floor
  # 公式 / Formula: max(0.2, threshold * multiplier)
  # 较低的值让更多内容进入 AI 判断，适合中文新闻同义表达 / Lower for Chinese news with synonyms
  candidate_floor_multiplier: 0.35

  # 最大 AI 检查次数 / Maximum AI check count
  # AI 判断用于相似度接近阈值的场景 / AI used for borderline cases
  max_ai_checks: 50


# ═══════════════════════════════════════════════════════════════
# 3. Ollama 配置 / Ollama Configuration
# ═══════════════════════════════════════════════════════════════
ollama:
  # 使用的模型 / Model name
  # 通过主 AI 的 LiteLLM 连接 Ollama，base_url 由主 AI 配置决定
  model: "qwen2.5:14b-instruct"


# ═══════════════════════════════════════════════════════════════
# 4. 合并配置 / Merge Configuration
# ═══════════════════════════════════════════════════════════════
merge:
  # 来源分隔符 / Source name separator
  # 合并多个来源时使用的分隔符
  source_separator: " / "

  # 计数策略 / Count strategy
  # 可选值 / Options: sum (累加), max (取最大值)
  count_strategy: "sum"

  # 每组最大条目数 / Maximum items per group
  # 0 表示不限制 / 0 = no limit
  max_items_per_group: 10

# 自定义提示词文件路径 / Custom prompt file path
# 提示词文件相对路径，支持变量替换，包含 [system] 和 [user] 两个部分
# Prompt file path relative to project root, supports variable substitution with [system] and [user] sections
prompt_file: "config/dedupe_prompt.txt"


# ═══════════════════════════════════════════════════════════════
# 5. 显示配置 / Display Configuration
# ═══════════════════════════════════════════════════════════════
display:
  # 是否显示多平台链接 / Show multi-platform links
  # 在合并后的新闻标题下方显示各平台的原始链接
  show_multi_platform_links: true

  # 最大显示链接数 / Maximum links to display
  # 超过此数量的链接将被显示为 "+N更多"
  max_links: 5

  # 高亮主链接 / Highlight primary link
  # 是否对主链接（标题链接）使用特殊样式
  highlight_primary: true
